@model IEnumerable<string>
@{
    ViewBag.Title = "Photos";
    Layout = "~/Views/Shared/_LayoutMinimal.cshtml";
}
@section Styles
{
    <style>
        body {
            background-color: black;
        }

        .winLeft {
            background-color: green;
            color: white;
            padding: 10px;
            position: absolute;
            top: 0;
            left: 0;
            width: 50%;
            height: 100%;
            /*min-width: 80px;
            min-height: 100px;*/
        }
        .winRight {
            background-color: red;
            color: white;
            padding: 10px;
            position: absolute;
            top: 0;
            right: 0;
            width: 50%;
            height: 100%;
            /*min-width: 80px;
            min-height: 100px;*/
        }
    </style>
}
@*<div class="winLeft">
    <p id="counter"></p>
</div>
<div class="winRight">
    <p id="counter"></p>
</div>*@
<img id="thePic" class="ri" src="@Model.First()" />

@section Scripts
{
    <script type="text/javascript">
    var files = [
        @foreach (var f in Model)
	        {
                @:'@f',
    	        }
    ];
    var idx = 0;
    var totInterval = @ViewBag.HoldSeconds;
    var remainingInterval = @ViewBag.HoldSeconds;
        var ticInterval = 1;
        var isPlaying = true;
    //var isForward = true;

    var interval = null;

    function Advance(forward){
        idx += (forward ? 1 : -1);

        if (idx < 0)
            idx = files.length - 1;
        else if (idx > files.length - 1)
            idx = 0;

        $("#thePic").attr("src", files[idx]);
    }
        function Controller(){
            $("#counter").html(remainingInterval);

            if(isPlaying){
                remainingInterval -= ticInterval;

                if(remainingInterval<0){
                    remainingInterval = totInterval;
                    Advance(true);
                }
            }
        }

    $(function () {
        //DoSlideshow();
        setInterval(Controller,ticInterval * 1000);
        $("#thePic").click(function(e){
            e.stopPropagation();
            //DoSlideshow();
            isPlaying = !isPlaying;
        });
        $(document).click(function(e){

            if(isPlaying)
                isPlaying = false;

            var third = screen.width / 3;
            var cx = e.clientX;
            var sw = screen.width;

            forward = (cx > sw / 2);
            Advance(forward);

            //if(cx < third)
            //    Advance(false);
            //else if(cx > sw - third)
            //    Advance(true);
            //var cy = e.clientY;
            //var sx = e.screenX;
            //var sy = e.screenY;
            //var sh = screen.height;
        });
    })
    </script>
}